using System;
using System.Collections.Generic;
using System.Text;

namespace DevTKSS.Extensions.OAuth.Defaults;

public static class OAuthDefaults
{
    public static class Keys
    {
        /// <summary>
        /// oAuth Token Request standarized keys from <see href="https://datatracker.ietf.org/doc/html/rfc6749#section-4.1.3">4.1.3 Access Token Request</see>
        /// </summary>
        public const string GrantType = "grant_type";

        /// <summary>
        /// REQUIRED.  The authorization code generated by the
        /// authorization server.The authorization code MUST expire
        /// shortly after it is issued to mitigate the risk of leaks.A
        /// maximum authorization code lifetime of 10 minutes is
        /// RECOMMENDED.The client MUST NOT use the authorization code
        /// more than once.  If an authorization code is used more than
        /// once, the authorization server MUST deny the request and SHOULD
        /// revoke(when possible) all tokens previously issued based on
        /// that authorization code.The authorization code is bound to
        /// the client identifier and redirection URI.
        /// </summary>
        public const string Code = "code";

        /// <summary>
        /// REQUIRED.The client identifier as described in Section 2.2.
        /// </summary>
        public const string ClientId = "client_id";

        /// <summary>
        /// OPTIONAL.  As described in Section <see href="https://datatracker.ietf.org/doc/html/rfc6749#section-3.1.2">3.1.2</see>.
        /// </summary>
        public const string RedirectUri = "redirect_uri";

        public const string ResponseType = "response_type";

        /// <summary>
        /// RECOMMENDED. An opaque value used by the client to maintain
        /// state between the request and callback.The authorization
        /// server includes this value when redirecting the user-agent back
        /// to the client.
        /// </summary>
        public const string State = "state";

        /// <summary>
        /// OPTIONAL.  The scope of the access request as described by <see href="https://datatracker.ietf.org/doc/html/rfc6749#section-3.3">Section 3.3</see>.
        /// </summary>
        public const string Scope = "scope";

        public const string AccessToken = "access_token";
        public const string RefreshToken = "refresh_token";
        public const string TokenType = "token_type";
        public const string ExpiresIn = "expires_in";

        public static class Pkce
        {
            public const string CodeChallenge = "code_challenge";
            public const string CodeChallengeMethod = "code_challenge_method";

            /// <summary>
            /// The PKCE code verifier preimage of the code_challenge used in the prior authorization code request.
            /// </summary>
            public const string CodeVerifier = "code_verifier";
        }

        public static class Error
        {
            public const string Key = "error";
            public const string Description = "error_description";
            public const string Uri = "error_uri";
        }
    }

    public static class Values
    {
        public const string AuthorizationCode = "authorization_code";
        public const string RefreshToken = "refresh_token";

        /// <summary>
        /// REQUIRED. Value the Response Type MUST be set to "code".
        /// </summary>
        public const string Code = "code"; // FÃ¼r response_type

        public const string S256 = "S256";

        /// <summary>
        /// OAuthDefaults Error Response standardized error codes. <see href="https://datatracker.ietf.org/doc/html/rfc6749#section-4.1.2.1">4.1.2.1 Error Response</see>
        /// </summary>
        public static class Errors
        {
            public const string AccessDenied = "access_denied";
            public const string InvalidRequest = "invalid_request";
            public const string UnauthorizedClient = "unauthorized_client";
            public const string InvalidClient = "invalid_client";
            public const string InvalidGrant = "invalid_grant";
            public const string UnsupportedGrantType = "unsupported_grant_type";
            public const string InvalidScope = "invalid_scope";
            public const string TemporarilyUnavailable = "temporarily_unavailable";
        }
    }
}
